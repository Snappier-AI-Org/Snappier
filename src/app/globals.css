@import "tailwindcss";
@import "tw-animate-css";

@custom-variant dark (&:is(.dark *));

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
  --color-sidebar-ring: var(--sidebar-ring);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar: var(--sidebar);
  --color-chart-5: var(--chart-5);
  --color-chart-4: var(--chart-4);
  --color-chart-3: var(--chart-3);
  --color-chart-2: var(--chart-2);
  --color-chart-1: var(--chart-1);
  --color-ring: var(--ring);
  --color-input: var(--input);
  --color-border: var(--border);
  --color-destructive: var(--destructive);
  --color-accent-foreground: var(--accent-foreground);
  --color-accent: var(--accent);
  --color-muted-foreground: var(--muted-foreground);
  --color-muted: var(--muted);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-secondary: var(--secondary);
  --color-primary-foreground: var(--primary-foreground);
  --color-primary: var(--primary);
  --color-popover-foreground: var(--popover-foreground);
  --color-popover: var(--popover);
  --color-card-foreground: var(--card-foreground);
  --color-card: var(--card);
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
  --font-serif: Source Serif 4, serif;
  --radius: 0.425rem;
  --tracking-tighter: calc(var(--tracking-normal) - 0.05em);
  --tracking-tight: calc(var(--tracking-normal) - 0.025em);
  --tracking-wide: calc(var(--tracking-normal) + 0.025em);
  --tracking-wider: calc(var(--tracking-normal) + 0.05em);
  --tracking-widest: calc(var(--tracking-normal) + 0.1em);
  --tracking-normal: var(--tracking-normal);
  --shadow-2xl: var(--shadow-2xl);
  --shadow-xl: var(--shadow-xl);
  --shadow-lg: var(--shadow-lg);
  --shadow-md: var(--shadow-md);
  --shadow: var(--shadow);
  --shadow-sm: var(--shadow-sm);
  --shadow-xs: var(--shadow-xs);
  --shadow-2xs: var(--shadow-2xs);
  --spacing: var(--spacing);
  --letter-spacing: var(--letter-spacing);
  --shadow-offset-y: var(--shadow-offset-y);
  --shadow-offset-x: var(--shadow-offset-x);
  --shadow-spread: var(--shadow-spread);
  --shadow-blur: var(--shadow-blur);
  --shadow-opacity: var(--shadow-opacity);
  --color-shadow-color: var(--shadow-color);
  --color-destructive-foreground: var(--destructive-foreground);
}

:root {
  --radius: 0.625rem;
  
  /* ===== Greenhouse Light Theme - Light Mode ===== */
  /* Inspired by a bright, modern botanical greenhouse */
  
  /* Snappier Primary Colors - Technical Botanical */
  --snap-primary: #22C55E;           /* Snap Green - main brand color */
  --snap-primary-hover: #16A34A;     /* Darker green on hover */
  --snap-primary-glow: rgba(34, 197, 94, 0.35);
  --snap-active: #4ADE80;            /* Glowing active state */
  --snap-secondary: #2DD4BF;         /* Teal accent - secondary */
  --snap-accent: #86EFAC;            /* Light mint - highlights */
  --snap-forest: #14532D;            /* Deep forest accent */
  
  /* Greenhouse Surface Effects */
  --greenhouse-light: #F8FAF7;       /* Warm sage-white base */
  --greenhouse-paper: #F1F5F0;       /* Paper texture off-white */
  --greenhouse-moss: rgba(34, 197, 94, 0.08);  /* Subtle moss tint */
  --greenhouse-dew: rgba(134, 239, 172, 0.15); /* Morning dew effect */
  
  /* Glass Effect Colors - greenhouse glass */
  --glass-white: rgba(255, 255, 255, 0.75);
  --glass-border: rgba(34, 197, 94, 0.15);
  --glass-hover: rgba(34, 197, 94, 0.1);
  --glass-mint: rgba(134, 239, 172, 0.2);

  /* UI & Functional Colors */
  --snap-canvas: #F8FAF7;            /* Greenhouse light background */
  --snap-surface: #FFFFFF;
  --snap-grid-dots: rgba(34, 197, 94, 0.12);
  --snap-card-bg: rgba(255, 255, 255, 0.92);
  --snap-stroke: rgba(34, 197, 94, 0.18);

  /* Typography Colors */
  --snap-text-primary: #14532D;      /* Deep forest text */
  --snap-text-secondary: #166534;
  --snap-text-tertiary: #22C55E;

  /* Tendril Connection Colors */
  --tendril-color: #64748B;          /* Neutral gray tendril */
  --tendril-active: #22C55E;         /* Green when active */
  --tendril-glow: rgba(34, 197, 94, 0.5);

  /* Warning/Error - Autumn Colors */
  --withered-yellow: #F59E0B;        /* Warning - autumn yellow */
  --autumn-red: #EF4444;             /* Error - withered red */

  /* Flow Animation Colors */
  --flow-color-start: #22C55E;
  --flow-color-mid: #4ADE80;
  --flow-color-end: #86EFAC;
  --edge-color-start: rgba(34, 197, 94, 0.6);
  --edge-color-end: rgba(45, 212, 191, 0.6);

  /* Updated color scheme with Vine & Tendril theme */
  --background: oklch(0.98 0.01 145);
  --foreground: oklch(0.20 0.06 145);
  --card: oklch(1 0 0);
  --card-foreground: oklch(0.20 0.05 145);
  --popover: oklch(0.99 0.005 145);
  --popover-foreground: oklch(0.20 0.05 145);
  --primary: oklch(0.60 0.20 145);
  --primary-foreground: oklch(1 0 0);
  --secondary: oklch(0.96 0.02 145);
  --secondary-foreground: oklch(0.25 0.10 145);
  --muted: oklch(0.97 0.01 145);
  --muted-foreground: oklch(0.45 0.06 145);
  --accent: oklch(0.90 0.08 145);
  --accent-foreground: oklch(0.20 0.10 145);
  --destructive: oklch(0.6368 0.2078 25.3313);
  --border: oklch(0.92 0.02 145);
  --input: oklch(0.97 0.01 145);
  --ring: oklch(0.60 0.20 145);
  --chart-1: oklch(0.60 0.20 145);
  --chart-2: oklch(0.65 0.18 165);
  --chart-3: oklch(0.55 0.15 135);
  --chart-4: oklch(0.50 0.22 145);
  --chart-5: oklch(0.70 0.12 155);
  --sidebar: oklch(0.98 0.01 145);
  --sidebar-foreground: oklch(0.20 0.06 145);
  --sidebar-primary: oklch(0.60 0.20 145);
  --sidebar-primary-foreground: oklch(1 0 0);
  /* Subtle accent - greenhouse tint */
  --sidebar-accent: oklch(0.94 0.03 145);
  --sidebar-accent-foreground: oklch(0.20 0.06 145);
  --sidebar-border: oklch(0.95 0.01 145);
  --sidebar-ring: oklch(0.60 0.20 145);
  --destructive-foreground: oklch(1 0 0);
  --font-sans: Inter, sans-serif;
  --font-serif: Source Serif 4, serif;
  --font-mono: JetBrains Mono, monospace;
  --shadow-color: hsl(145 40% 25%);
  --shadow-opacity: 0.08;
  --shadow-blur: 8px;
  --shadow-spread: 0px;
  --shadow-offset-x: 0px;
  --shadow-offset-y: 2px;
  --letter-spacing: 0em;
  --spacing: 0.25rem;
  --shadow-2xs: 0px 1px 2px 0px hsl(145 35% 25% / 0.04);
  --shadow-xs: 0px 1px 3px 0px hsl(145 35% 25% / 0.06);
  --shadow-sm:
    0px 1px 3px 0px hsl(145 35% 25% / 0.08), 0px 1px 2px -1px hsl(145 35% 25% / 0.06);
  --shadow:
    0px 2px 4px 0px hsl(145 35% 25% / 0.08), 0px 1px 3px -1px hsl(145 35% 25% / 0.06);
  --shadow-md:
    0px 4px 6px 0px hsl(145 35% 25% / 0.1), 0px 2px 4px -1px hsl(145 35% 25% / 0.08);
  --shadow-lg:
    0px 8px 12px 0px hsl(145 35% 25% / 0.12), 0px 4px 6px -1px hsl(145 35% 25% / 0.1);
  --shadow-xl:
    0px 16px 20px 0px hsl(145 35% 25% / 0.14), 0px 8px 10px -1px hsl(145 35% 25% / 0.1);
  --shadow-2xl: 0px 24px 48px 0px hsl(145 35% 25% / 0.2);
  --tracking-normal: 0em;
}

.dark {
  /* ===== Deep Forest Theme - Dark Mode ===== */
  /* Inspired by a mystical night jungle with bioluminescent plants */
  
  /* Snappier Primary Colors - Night Jungle */
  --snap-primary: #22C55E;           /* Snap Green - glowing in dark */
  --snap-primary-hover: #4ADE80;     /* Brighter on hover */
  --snap-primary-glow: rgba(34, 197, 94, 0.5);
  --snap-active: #4ADE80;            /* Glowing active state */
  --snap-secondary: #2DD4BF;         /* Teal accent */
  --snap-accent: #86EFAC;            /* Bioluminescent highlights */
  --snap-forest: #052E16;            /* Deepest forest */
  
  /* Button-specific colors */
  --button-primary-bg: #166534;      /* Deep forest green for buttons */
  --button-primary-hover: #15803D;   /* Lighter on hover */
  --button-primary-border: rgba(74, 222, 128, 0.3); /* Subtle glow border */
  
  /* Deep Forest Effects */
  --forest-deep: #06120E;            /* Night jungle - darkest */
  --forest-mid: #0A1F15;             /* Mid-depth forest */
  --forest-glow: rgba(34, 197, 94, 0.15); /* Ambient bioluminescence */
  --forest-particle: rgba(134, 239, 172, 0.6); /* Floating spores */
  
  /* Glass Effect Colors - murky jungle night */
  --glass-white: rgba(255, 255, 255, 0.06);
  --glass-border: rgba(34, 197, 94, 0.18);
  --glass-hover: rgba(74, 222, 128, 0.12);
  --glass-moss: rgba(34, 197, 94, 0.1);

  /* UI & Functional Colors */
  --snap-canvas: #06120E;            /* Night jungle background */
  --snap-surface: #11221B;           /* Moss surface */
  --snap-grid-dots: rgba(34, 197, 94, 0.2);
  --snap-card-bg: rgba(17, 34, 27, 0.8);
  --snap-stroke: rgba(34, 197, 94, 0.2);

  /* Typography Colors */
  --snap-text-primary: #E8FCF0;      /* Soft moonlit white */
  --snap-text-secondary: #86EFAC;    /* Glowing mint text */
  --snap-text-tertiary: #4ADE80;     /* Bioluminescent */

  /* Tendril Connection Colors - Dark Mode */
  --tendril-color: #475569;          /* Slate gray tendril */
  --tendril-active: #4ADE80;         /* Glowing green when active */
  --tendril-glow: rgba(74, 222, 128, 0.6);

  /* Flow Animation Colors - Dark Mode */
  --flow-color-start: #22C55E;
  --flow-color-mid: #4ADE80;
  --flow-color-end: #86EFAC;
  --edge-color-start: rgba(34, 197, 94, 0.7);
  --edge-color-end: rgba(45, 212, 191, 0.7);

  --background: oklch(0.10 0.03 155);
  --foreground: oklch(0.95 0.01 145);
  --card: oklch(0.14 0.035 155);
  --card-foreground: oklch(0.95 0.01 145);
  --popover: oklch(0.12 0.03 155);
  --popover-foreground: oklch(0.95 0.01 145);
  --primary: oklch(0.60 0.25 145);
  --primary-foreground: oklch(1 0 0);
  --secondary: oklch(0.18 0.04 155);
  --secondary-foreground: oklch(0.92 0.02 145);
  --muted: oklch(0.16 0.03 155);
  --muted-foreground: oklch(0.65 0.05 145);
  --accent: oklch(0.20 0.05 155);
  --accent-foreground: oklch(0.92 0.02 145);
  --destructive: oklch(0.55 0.22 25);
  --border: oklch(0.22 0.04 155);
  --input: oklch(0.16 0.03 155);
  --ring: oklch(0.60 0.25 145);
  --chart-1: oklch(0.60 0.25 145);
  --chart-2: oklch(0.55 0.20 165);
  --chart-3: oklch(0.65 0.18 135);
  --chart-4: oklch(0.50 0.22 155);
  --chart-5: oklch(0.45 0.18 175);
  --sidebar: oklch(0.08 0.025 155);
  --sidebar-foreground: oklch(0.90 0.02 145);
  --sidebar-primary: oklch(0.60 0.25 145);
  --sidebar-primary-foreground: oklch(1 0 0);
  --sidebar-accent: oklch(0.14 0.035 155);
  --sidebar-accent-foreground: oklch(0.90 0.02 145);
  --sidebar-border: oklch(0.20 0.04 155);
  --sidebar-ring: oklch(0.60 0.25 145);
  --destructive-foreground: oklch(0.95 0 0);
  --radius: 0.425rem;
  --font-sans: Inter, sans-serif;
  --font-serif: Source Serif 4, serif;
  --font-mono: JetBrains Mono, monospace;
  --shadow-color: hsl(155 80% 5%);
  --shadow-opacity: 0.5;
  --shadow-blur: 16px;
  --shadow-spread: 0px;
  --shadow-offset-x: 0px;
  --shadow-offset-y: 4px;
  --letter-spacing: 0em;
  --spacing: 0.25rem;
  --shadow-2xs: 0px 1px 2px 0px hsl(155 50% 5% / 0.4);
  --shadow-xs: 0px 1px 3px 0px hsl(155 50% 5% / 0.45);
  --shadow-sm:
    0px 2px 4px 0px hsl(155 50% 5% / 0.5), 0px 1px 2px -1px hsl(155 50% 5% / 0.4);
  --shadow:
    0px 2px 6px 0px hsl(155 50% 5% / 0.4), 0px 1px 3px -1px hsl(155 50% 5% / 0.4);
  --shadow-md:
    0px 4px 8px 0px hsl(155 50% 5% / 0.45), 0px 2px 4px -1px hsl(155 50% 5% / 0.45);
  --shadow-lg:
    0px 8px 16px 0px hsl(155 50% 5% / 0.5), 0px 4px 6px -1px hsl(155 50% 5% / 0.5);
  --shadow-xl:
    0px 16px 24px 0px hsl(155 50% 5% / 0.55), 0px 8px 10px -1px hsl(155 50% 5% / 0.55);
  --shadow-2xl: 0px 24px 48px 0px hsl(155 50% 5% / 0.6);
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  body {
    @apply bg-background text-foreground;
    letter-spacing: var(--tracking-normal);
  }
}

/* Ensure chat messages wrap properly */
.overflow-wrap-anywhere {
  overflow-wrap: anywhere;
  word-break: break-word;
}

@layer base {
  button:not([disabled]),
  [role="button"]:not([disabled]) {
    cursor: pointer;
  }
}

/* ========================================================================== */
/* ===== NODE STATUS STYLING - Execution State Visual Feedback ===== */
/* ========================================================================== */
/* Ensures node borders change color during workflow execution */
/* Running = Blue, Success = Green, Error = Red */

/* Ensure border-3 class works (used by NodeStatusIndicator) */
.border-3 {
  border-width: 3px !important;
  border-style: solid !important;
}

/* Base node status - border only, no outer glow */
#base-node.border-blue-500 {
  border-color: rgb(59, 130, 246) !important;
}

#base-node.border-green-500 {
  border-color: rgb(34, 197, 94) !important;
}

#base-node.border-red-500 {
  border-color: rgb(239, 68, 68) !important;
}

/* StatusBorder component status colors */
.border-green-500\/50,
.border-green-400\/50 {
  border-color: rgba(34, 197, 94, 0.5) !important;
}

.border-red-700\/50 {
  border-color: rgba(185, 28, 28, 0.5) !important;
}

.border-blue-700\/40 {
  border-color: rgba(29, 78, 216, 0.4) !important;
}

/* Dark mode node status - border only, no outer glow */
.dark #base-node.border-blue-500 {
  border-color: rgb(96, 165, 250) !important;
}

.dark #base-node.border-green-500 {
  border-color: rgb(74, 222, 128) !important;
}

.dark #base-node.border-red-500 {
  border-color: rgb(248, 113, 113) !important;
}

/* Dark mode StatusBorder - subtle border only */
.dark .border-green-500\/50,
.dark .border-green-400\/50 {
  border-color: rgba(74, 222, 128, 0.6) !important;
}

.dark .border-red-700\/50 {
  border-color: rgba(248, 113, 113, 0.6) !important;
}

.dark .border-blue-700\/40 {
  border-color: rgba(96, 165, 250, 0.5) !important;
}

/* React Flow node selection styles */
.react-flow__node.selected #base-node {
  @apply ring-2 ring-muted-foreground/20;
}

/* Override selection ring when node has execution status */
.react-flow__node.selected #base-node[class*="border-green"] {
  --tw-ring-color: rgba(34, 197, 94, 0.3);
}

.react-flow__node.selected #base-node[class*="border-red"] {
  --tw-ring-color: rgba(239, 68, 68, 0.3);
}

.react-flow__node.selected #base-node[class*="border-blue"] {
  --tw-ring-color: rgba(59, 130, 246, 0.3);
}

/* ===== React Flow Light Mode - Greenhouse Theme ===== */
/* Inspired by a bright botanical greenhouse with organic patterns */
/* GRADIENT DIRECTION: Outside-In with subtle vine texture */

:root {
  --flow-dot-color: rgba(34, 197, 94, 0.1);
}

.react-flow {
  /* ============================================================
     LIGHT MODE CANVAS GRADIENT - GREENHOUSE LIGHT
     ============================================================
     Warm, botanical-inspired canvas with organic feel.
     
     HOW TO ADJUST:
     
     1. EDGE GRADIENTS (Top, Left, Right, Bottom):
        - Subtle greenhouse leaf tints
        - Adjust rgba() opacity for intensity
     
     2. CORNER VIGNETTES:
        - Soft moss/mint corner accents
     
     3. BASE COLOR:
        - Warm sage-white paper texture
     ============================================================ */
  
  background: 
    /* ===== TOP EDGE - Soft canopy light ===== */
    linear-gradient(to bottom, 
      rgba(134, 239, 172, 0.12) 0%,    /* Mint leaf edge */
      rgba(134, 239, 172, 0.04) 8%,
      transparent 15%
    ),
    
    /* ===== BOTTOM EDGE - Forest floor gradient ===== */
    linear-gradient(to top, 
      rgba(34, 197, 94, 0.06) 0%,      /* Moss edge */
      rgba(34, 197, 94, 0.02) 5%,
      transparent 12%
    ),
    
    /* ===== LEFT EDGE - Vine tint ===== */
    linear-gradient(to right, 
      rgba(45, 212, 191, 0.08) 0%,     /* Teal tendril edge */
      rgba(45, 212, 191, 0.02) 6%,
      transparent 12%
    ),
    
    /* ===== RIGHT EDGE - Vine tint ===== */
    linear-gradient(to left, 
      rgba(45, 212, 191, 0.08) 0%,
      rgba(45, 212, 191, 0.02) 6%,
      transparent 12%
    ),
    
    /* ===== CORNER VIGNETTES - Organic moss tints ===== */
    /* Top-left corner */
    radial-gradient(ellipse 35% 35% at 0% 0%, 
      rgba(134, 239, 172, 0.1) 0%, 
      transparent 70%
    ),
    /* Top-right corner */
    radial-gradient(ellipse 35% 35% at 100% 0%, 
      rgba(134, 239, 172, 0.08) 0%, 
      transparent 70%
    ),
    /* Bottom-left corner */
    radial-gradient(ellipse 30% 30% at 0% 100%, 
      rgba(34, 197, 94, 0.06) 0%, 
      transparent 70%
    ),
    /* Bottom-right corner */
    radial-gradient(ellipse 30% 30% at 100% 100%, 
      rgba(34, 197, 94, 0.06) 0%, 
      transparent 70%
    ),
    
    /* ===== NEURAL LEAF PATTERN - Subtle vine mesh overlay ===== */
    url('/assets/vine-mesh.svg'),
    
    /* ===== BASE COLOR - Greenhouse paper ===== */
    linear-gradient(180deg, 
      rgba(248, 250, 247, 1) 0%,       /* Warm sage-white */
      rgba(255, 255, 255, 1) 100%
    );
}

.react-flow__background {
  background: transparent !important;
}

.react-flow__controls {
  background-color: rgba(255, 255, 255, 0.92);
  border: 1px solid rgba(34, 197, 94, 0.2);
  border-radius: 14px;
  overflow: hidden;
  box-shadow: 
    0 2px 8px rgba(34, 197, 94, 0.1),
    0 4px 16px rgba(45, 212, 191, 0.05);
  backdrop-filter: blur(8px);
}

.react-flow__controls button {
  background-color: rgba(255, 255, 255, 0.85);
  border-bottom: 1px solid rgba(34, 197, 94, 0.1);
  color: #166534;
  width: 28px;
  height: 28px;
}

.react-flow__controls button:last-child {
  border-bottom: none;
}

.react-flow__controls button:hover {
  background-color: rgba(34, 197, 94, 0.12);
  color: #22C55E;
}

.react-flow__minimap {
  background-color: rgba(255, 255, 255, 0.92);
  border: 1px solid rgba(34, 197, 94, 0.2);
  border-radius: 14px;
  overflow: hidden;
  backdrop-filter: blur(8px);
}

/* Tendril connection styles - organic vine paths */
.react-flow__edge {
  stroke: var(--tendril-color, #64748B);
  stroke-width: 2px;
  stroke-linecap: round;
}

.react-flow__edge.selected {
  stroke: var(--snap-primary, #22C55E);
  stroke-width: 2.5px;
  filter: drop-shadow(0 0 4px rgba(34, 197, 94, 0.4));
}

.react-flow__connectionline {
  stroke: var(--snap-active, #4ADE80);
  stroke-width: 2px;
  stroke-dasharray: 8 4;
  stroke-linecap: round;
}

/* Pebble-shaped handles */
.react-flow__handle {
  background-color: rgba(255, 255, 255, 0.95);
  border: 2px solid var(--snap-primary, #22C55E);
  width: 10px;
  height: 10px;
  border-radius: 50%;
  transition: all 0.2s ease;
}

.react-flow__handle.connectable:hover {
  background-color: var(--snap-active, #4ADE80);
  border-color: var(--snap-primary, #22C55E);
  box-shadow: 0 0 10px rgba(34, 197, 94, 0.5);
  transform: scale(1.2);
}

/* ===== React Flow Dark Mode - Deep Forest Theme ===== */
/* Night jungle with bioluminescent plant glows */

.dark {
  --flow-dot-color: rgba(74, 222, 128, 0.2);
}

.dark .react-flow {
  /* Deep forest gradient with bioluminescent spots */
  background: 
    /* Bioluminescent ambient glow spots - like glowing moss */
    radial-gradient(ellipse 60% 40% at 20% 30%, rgba(34, 197, 94, 0.08) 0%, transparent 50%),
    radial-gradient(ellipse 50% 50% at 80% 70%, rgba(45, 212, 191, 0.05) 0%, transparent 40%),
    radial-gradient(ellipse 70% 30% at 60% 20%, rgba(74, 222, 128, 0.04) 0%, transparent 45%),
    /* Neural leaf pattern overlay */
    url('/assets/vine-mesh.svg'),
    /* Deep forest gradient - darkest at edges */
    radial-gradient(ellipse 120% 100% at 50% 50%, 
      rgba(17, 34, 27, 0.95) 0%, 
      rgba(6, 18, 14, 1) 70%,
      rgba(0, 0, 0, 1) 100%
    );
}

.dark .react-flow__background {
  background: transparent !important;
}

.dark .react-flow__controls {
  background-color: rgba(17, 34, 27, 0.85);
  border: 1px solid rgba(34, 197, 94, 0.2);
  box-shadow: 
    0 2px 12px rgba(0, 0, 0, 0.3),
    inset 0 1px 0 rgba(74, 222, 128, 0.1);
  backdrop-filter: blur(12px);
}

.dark .react-flow__controls button {
  background-color: transparent;
  border-bottom: 1px solid rgba(34, 197, 94, 0.15);
  color: #86EFAC;
}

.dark .react-flow__controls button:hover {
  background-color: rgba(34, 197, 94, 0.2);
  color: #4ADE80;
}

.dark .react-flow__minimap {
  background-color: rgba(17, 34, 27, 0.85);
  border: 1px solid rgba(34, 197, 94, 0.2);
  backdrop-filter: blur(12px);
}

/* Dark mode tendril connections */
.dark .react-flow__edge {
  stroke: var(--tendril-color, #475569);
  stroke-width: 2px;
  stroke-linecap: round;
}

.dark .react-flow__edge.selected {
  stroke: var(--snap-active, #4ADE80);
  stroke-width: 2.5px;
  filter: drop-shadow(0 0 6px rgba(74, 222, 128, 0.6));
}

.dark .react-flow__connectionline {
  stroke: var(--snap-active, #4ADE80);
  stroke-width: 2px;
  stroke-dasharray: 8 4;
  stroke-linecap: round;
}

.dark .react-flow__handle {
  background-color: rgba(17, 34, 27, 0.9);
  border: 2px solid var(--snap-primary, #22C55E);
  transition: all 0.2s ease;
}

.dark .react-flow__handle.connectable {
  background-color: rgba(34, 197, 94, 0.3);
  border-color: var(--snap-primary, #22C55E);
}

.dark .react-flow__handle.connectable:hover {
  background-color: var(--snap-active, #4ADE80);
  border-color: var(--snap-active, #4ADE80);
  box-shadow: 
    0 0 14px rgba(74, 222, 128, 0.7),
    0 0 28px rgba(34, 197, 94, 0.4);
  transform: scale(1.2);
}

/* ===== Animated Edge Styles ===== */

/* Default edge style - no animation */
.react-flow__edge-path {
  stroke-dasharray: none;
  transition: stroke 0.2s ease, stroke-width 0.2s ease;
}

/* ===== THE SNAP - Vine & Tendril Execution Animation ===== */
/* Organic sap-flow with snap particles effect */

/* Base executing edge - organic vine pulse */
.workflow-executing .react-flow__edge-path {
  stroke-dasharray: none;
  stroke-width: 2.5px;
  animation: vine-pulse 2s ease-in-out infinite;
}

/* Snap pulse - organic thickening wave traveling along the vine */
@keyframes vine-pulse {
  0%, 100% {
    stroke-width: 2px;
    filter: drop-shadow(0 0 2px var(--snap-primary-glow));
  }
  50% {
    stroke-width: 3.5px;
    filter: drop-shadow(0 0 8px var(--snap-primary-glow))
            drop-shadow(0 0 16px rgba(74, 222, 128, 0.3));
  }
}

/* Active animated edge during execution - sap flow effect */
.workflow-executing .react-flow__edge.animated .react-flow__edge-path {
  stroke-dasharray: 12 6 4 6;
  animation: sap-flow 0.8s linear infinite, vine-pulse 2s ease-in-out infinite;
}

/* Spore travel along edge path using offset-path */
@keyframes spore-travel {
  0% {
    offset-distance: 0%;
    opacity: 0;
    transform: scale(0.5);
  }
  5% {
    opacity: 1;
    transform: scale(1);
  }
  50% {
    transform: scale(1.3);
  }
  95% {
    opacity: 1;
    transform: scale(1);
  }
  100% {
    offset-distance: 100%;
    opacity: 0;
    transform: scale(0.5);
  }
}

/* Snap connection animation - tendril wrapping effect */
@keyframes tendril-wrap {
  0% {
    stroke-dasharray: 4 4;
    stroke-dashoffset: 100;
  }
  50% {
    stroke-dasharray: 8 2;
  }
  100% {
    stroke-dasharray: 0;
    stroke-dashoffset: 0;
  }
}

/* Node receiving data - snap arrival effect */
@keyframes snap-receive {
  0% {
    transform: scale(1);
    box-shadow: 0 0 0 0 var(--snap-primary-glow);
  }
  30% {
    transform: scale(1.03);
    box-shadow: 0 0 20px 4px var(--snap-primary-glow);
  }
  60% {
    transform: scale(0.98);
  }
  100% {
    transform: scale(1);
    box-shadow: 0 0 0 0 transparent;
  }
}

.node-snap-receive {
  animation: snap-receive 0.4s ease-out forwards;
}

/* ===== Sap Flow Layer Animation ===== */
@keyframes sap-flow {
  0% {
    stroke-dashoffset: 28;
  }
  100% {
    stroke-dashoffset: 0;
  }
}

/* ===== SNAP FLOW - Main edge animation ===== */
/* Smooth flowing particles along the edge connection */
@keyframes snapFlow {
  0% {
    stroke-dashoffset: 20;
  }
  100% {
    stroke-dashoffset: 0;
  }
}

/* ===== SNAP BURST - Node completion effect ===== */
/* When a node completes, the connection "snaps" with a burst */

@keyframes snap-burst {
  0% {
    stroke-width: 2px;
    filter: none;
  }
  15% {
    stroke-width: 5px;
    filter: drop-shadow(0 0 12px rgba(74, 222, 128, 0.9))
            drop-shadow(0 0 24px rgba(34, 197, 94, 0.6));
  }
  30% {
    stroke-width: 2px;
    filter: drop-shadow(0 0 20px rgba(74, 222, 128, 0.7));
  }
  50% {
    stroke-width: 3px;
    filter: drop-shadow(0 0 8px rgba(74, 222, 128, 0.5));
  }
  100% {
    stroke-width: 2px;
    filter: drop-shadow(0 0 3px rgba(34, 197, 94, 0.3));
  }
}

/* Tendril reach animation - connection stretches toward target */
@keyframes tendril-reach {
  0% {
    stroke-dasharray: 0 1000;
    stroke-dashoffset: 0;
  }
  60% {
    stroke-dasharray: 1000 0;
    stroke-dashoffset: 0;
  }
  75% {
    stroke-width: 4px;
  }
  100% {
    stroke-dasharray: 1000 0;
    stroke-width: 2px;
  }
}

/* Elastic snap-back effect */
@keyframes elastic-snap {
  0% {
    transform: scaleX(1);
  }
  20% {
    transform: scaleX(1.03);
  }
  40% {
    transform: scaleX(0.98);
  }
  60% {
    transform: scaleX(1.01);
  }
  80% {
    transform: scaleX(0.995);
  }
  100% {
    transform: scaleX(1);
  }
}

/* Apply snap burst to edges when node succeeds */
.edge-snap-success .react-flow__edge-path {
  animation: snap-burst 0.6s ease-out forwards, vine-pulse 2s ease-in-out infinite;
}

/* Apply error snap (red) when node fails */
@keyframes snap-burst-error {
  0% {
    stroke-width: 2px;
    stroke: var(--tendril-color);
    filter: none;
  }
  15% {
    stroke-width: 5px;
    stroke: #ef4444;
    filter: drop-shadow(0 0 12px rgba(239, 68, 68, 0.9))
            drop-shadow(0 0 24px rgba(239, 68, 68, 0.6));
  }
  30% {
    stroke-width: 2px;
    stroke: #f87171;
    filter: drop-shadow(0 0 20px rgba(248, 113, 113, 0.7));
  }
  100% {
    stroke-width: 2px;
    stroke: var(--tendril-color);
    filter: none;
  }
}

.edge-snap-error .react-flow__edge-path {
  animation: snap-burst-error 0.8s ease-out forwards;
}

/* ===== SPORE PARTICLES - Floating energy particles ===== */
/* Small glowing dots that travel along the connection */

@keyframes spore-float {
  0% {
    offset-distance: 0%;
    opacity: 0;
    transform: scale(0.5);
  }
  10% {
    opacity: 1;
    transform: scale(1);
  }
  50% {
    transform: scale(1.2);
  }
  90% {
    opacity: 1;
    transform: scale(1);
  }
  100% {
    offset-distance: 100%;
    opacity: 0;
    transform: scale(0.5);
  }
}

/* Spore travel along edge path using offset-path */
@keyframes spore-travel {
  0% {
    offset-distance: 0%;
    opacity: 0;
    transform: scale(0.5);
  }
  5% {
    opacity: 1;
    transform: scale(1);
  }
  50% {
    transform: scale(1.3);
  }
  95% {
    opacity: 1;
    transform: scale(1);
  }
  100% {
    offset-distance: 100%;
    opacity: 0;
    transform: scale(0.5);
  }
}

/* Snap connection animation - tendril wrapping effect */
@keyframes tendril-wrap {
  0% {
    stroke-dasharray: 4 4;
    stroke-dashoffset: 100;
  }
  50% {
    stroke-dasharray: 8 2;
  }
  100% {
    stroke-dasharray: 0;
    stroke-dashoffset: 0;
  }
}

/* Node receiving data - snap arrival effect */
@keyframes snap-receive {
  0% {
    transform: scale(1);
    box-shadow: 0 0 0 0 var(--snap-primary-glow);
  }
  30% {
    transform: scale(1.03);
    box-shadow: 0 0 20px 4px var(--snap-primary-glow);
  }
  60% {
    transform: scale(0.98);
  }
  100% {
    transform: scale(1);
    box-shadow: 0 0 0 0 transparent;
  }
}

.node-snap-receive {
  animation: snap-receive 0.4s ease-out forwards;
}

/* ===== Sap Flow Layer Animation ===== */
@keyframes sap-flow {
  0% {
    stroke-dashoffset: 28;
  }
  100% {
    stroke-dashoffset: 0;
  }
}

/* ========================================================================== */
/* ===== GREENHOUSE LIGHT - Light Mode Interactive Effects ===== */
/* ========================================================================== */
/* Light mode uses subtle shadow/darkening on interaction (opposite of glow) */

/* ===== Light Mode Variables ===== */
:root {
  /* Greenhouse Interaction Colors */
  --surface-shadow: rgba(34, 197, 94, 0.12);
  --surface-shadow-hover: rgba(34, 197, 94, 0.2);
  --surface-darken: rgba(22, 163, 74, 0.08);
  --surface-press: rgba(22, 163, 74, 0.15);
  --surface-border-focus: rgba(34, 197, 94, 0.4);
}

/* ===== Primary Buttons - Subtle Depth Effect ===== */
button[class*="bg-primary"]:not(.dark *),
.btn-primary:not(.dark *),
[class*="bg-primary"]:not([data-slot]):not(.react-flow__handle):not(.dark *) {
  transition: all 0.2s ease;
  box-shadow: 
    0 1px 3px rgba(22, 163, 74, 0.15),
    0 1px 2px rgba(0, 0, 0, 0.06);
}

button[class*="bg-primary"]:hover:not(.dark *),
.btn-primary:hover:not(.dark *),
[class*="bg-primary"]:not([data-slot]):not(.react-flow__handle):hover:not(.dark *) {
  box-shadow: 
    0 4px 12px rgba(22, 163, 74, 0.2),
    0 2px 4px rgba(0, 0, 0, 0.08),
    inset 0 -1px 0 rgba(22, 163, 74, 0.1);
  transform: translateY(-1px);
}

button[class*="bg-primary"]:active:not(.dark *),
.btn-primary:active:not(.dark *),
[class*="bg-primary"]:not([data-slot]):not(.react-flow__handle):active:not(.dark *) {
  box-shadow: 
    0 1px 2px rgba(22, 163, 74, 0.2),
    inset 0 2px 4px rgba(22, 163, 74, 0.15);
  transform: translateY(0);
}

/* Floating action buttons - Light mode */
button[class*="rounded-full"][class*="bg-primary"]:not(.dark *):not(.react-flow__handle),
[class*="rounded-full"][class*="bg-primary"]:not(.dark *):not(.react-flow__handle) {
  box-shadow: 
    0 4px 16px rgba(22, 163, 74, 0.15),
    0 2px 4px rgba(0, 0, 0, 0.08);
  transition: all 0.25s ease;
}

button[class*="rounded-full"][class*="bg-primary"]:hover:not(.dark *):not(.react-flow__handle),
[class*="rounded-full"][class*="bg-primary"]:hover:not(.dark *):not(.react-flow__handle) {
  box-shadow: 
    0 8px 24px rgba(22, 163, 74, 0.2),
    0 4px 8px rgba(0, 0, 0, 0.1);
  transform: scale(1.05) translateY(-2px);
}

/* ===== Cards & Entity Items - Depth on Hover ===== */
[data-slot="card"]:not(.dark *) {
  transition: all 0.2s ease;
}

[data-slot="card"]:hover:not(.dark *) {
  box-shadow: 
    0 4px 16px rgba(22, 163, 74, 0.1),
    0 2px 4px rgba(0, 0, 0, 0.05),
    0 8px 24px rgba(34, 197, 94, 0.08);
  transform: translateY(-2px);
}

.entity-item:not(.dark *) {
  transition: all 0.2s ease;
}

.entity-item:hover:not(.dark *) {
  box-shadow: 
    0 6px 20px rgba(22, 163, 74, 0.12),
    0 2px 6px rgba(0, 0, 0, 0.06);
  transform: translateY(-2px);
  border-color: rgba(34, 197, 94, 0.25);
}

/* ===== Outline/Ghost Buttons - Subtle Shadow ===== */
button[class*="variant-outline"]:not(.dark *),
button[class*="variant-ghost"]:not(.dark *),
button[class*="variant-secondary"]:not(.dark *) {
  transition: all 0.2s ease;
}

button[class*="variant-outline"]:hover:not(.dark *),
button[class*="variant-ghost"]:hover:not(.dark *),
button[class*="variant-secondary"]:hover:not(.dark *) {
  background: rgba(34, 197, 94, 0.06);
  box-shadow: 
    0 2px 8px rgba(22, 163, 74, 0.08),
    inset 0 0 0 1px rgba(34, 197, 94, 0.1);
}

button[class*="variant-outline"]:active:not(.dark *),
button[class*="variant-ghost"]:active:not(.dark *),
button[class*="variant-secondary"]:active:not(.dark *) {
  background: rgba(34, 197, 94, 0.1);
  box-shadow: inset 0 1px 3px rgba(22, 163, 74, 0.1);
}

/* ===== Input Fields - Focus Depth ===== */
input:not(.dark *),
textarea:not(.dark *),
[data-slot="select-trigger"]:not(.dark *) {
  transition: all 0.2s ease;
}

input:focus:not(.dark *),
textarea:focus:not(.dark *),
[data-slot="select-trigger"]:focus:not(.dark *) {
  box-shadow: 
    0 0 0 3px rgba(34, 197, 94, 0.1),
    0 2px 8px rgba(22, 163, 74, 0.08),
    inset 0 1px 2px rgba(22, 163, 74, 0.05);
  border-color: rgba(34, 197, 94, 0.4);
}

/* ===== Dropdowns & Popovers - Floating Shadow ===== */
[data-slot="dropdown-menu-content"]:not(.dark *),
[data-slot="popover-content"]:not(.dark *),
[data-slot="select-content"]:not(.dark *) {
  box-shadow: 
    0 8px 32px rgba(22, 163, 74, 0.12),
    0 4px 12px rgba(0, 0, 0, 0.08),
    0 0 1px rgba(34, 197, 94, 0.2);
}

[data-slot="dropdown-menu-item"]:hover:not(.dark *),
[data-slot="select-item"]:hover:not(.dark *) {
  background: linear-gradient(
    135deg,
    rgba(74, 222, 128, 0.08) 0%,
    rgba(134, 239, 172, 0.05) 100%
  );
}

/* ===== Dialog/Modal - Depth Shadow ===== */
[data-slot="dialog-content"]:not(.dark *),
[role="dialog"]:not(.dark *) {
  box-shadow: 
    0 16px 48px rgba(22, 163, 74, 0.15),
    0 8px 24px rgba(0, 0, 0, 0.1),
    0 0 1px rgba(34, 197, 94, 0.25);
}

/* ===== Add Node Panel - Light Mode ===== */
[cmdk-item]:not(.dark *),
[role="option"]:not(.dark *) {
  transition: all 0.2s ease;
  border-radius: 8px;
  margin: 2px 4px;
}

[cmdk-item]:hover:not(.dark *),
[cmdk-item][aria-selected="true"]:not(.dark *),
[role="option"]:hover:not(.dark *),
[role="option"][data-selected="true"]:not(.dark *) {
  background: linear-gradient(
    135deg,
    rgba(74, 222, 128, 0.1) 0%,
    rgba(134, 239, 172, 0.06) 100%
  );
  box-shadow: 
    0 2px 8px rgba(22, 163, 74, 0.08),
    inset 0 0 0 1px rgba(34, 197, 94, 0.15);
  transform: translateX(2px);
}

/* Category headers - Light mode */
[cmdk-group-heading]:not(.dark *) {
  color: rgba(22, 163, 74, 0.7);
  background: rgba(74, 222, 128, 0.05);
  padding: 8px 12px;
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

/* ===== React Flow Controls - Light Mode Depth ===== */
.react-flow__controls:not(.dark *) button {
  transition: all 0.2s ease;
}

.react-flow__controls:not(.dark *) button:hover {
  box-shadow: 
    0 2px 8px rgba(22, 163, 74, 0.12),
    inset 0 -1px 0 rgba(22, 163, 74, 0.08);
  transform: translateY(-1px);
}

.react-flow__controls:not(.dark *) button:active {
  box-shadow: inset 0 1px 3px rgba(22, 163, 74, 0.15);
  transform: translateY(0);
}

/* ===== Tabs - Light Mode ===== */
[data-slot="tabs-trigger"]:hover:not(.dark *) {
  background: rgba(74, 222, 128, 0.08);
  box-shadow: inset 0 -1px 0 rgba(34, 197, 94, 0.2);
}

[data-slot="tabs-trigger"][data-state="active"]:not(.dark *) {
  background: linear-gradient(
    180deg,
    rgba(74, 222, 128, 0.1) 0%,
    rgba(134, 239, 172, 0.05) 100%
  );
  box-shadow: 
    inset 0 -2px 0 rgba(34, 197, 94, 0.6),
    0 1px 4px rgba(22, 163, 74, 0.08);
}

/* ===== Sidebar - Light Mode Clean & Minimal ===== */
/* Items blend in, only show subtle darkening on hover/active */

/* Remove any visual box-shadow from sidebar container in light mode */
[data-sidebar]:not(.dark *) {
  box-shadow: none;
}

/* Sidebar inner should have no visual separation */
[data-sidebar="sidebar"]:not(.dark *) {
  background: transparent !important;
  box-shadow: none !important;
  border: none !important;
}

/* Sidebar content - no cards, no backgrounds */
[data-sidebar="content"]:not(.dark *) {
  background: transparent !important;
}

/* Sidebar groups should be invisible (no cards) */
[data-sidebar="group"]:not(.dark *) {
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
  border-radius: 0 !important;
}

[data-sidebar="menu"]:not(.dark *) {
  background: transparent !important;
  border-radius: 0 !important;
  box-shadow: none !important;
}

[data-sidebar="group-content"]:not(.dark *) {
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
}

[data-sidebar="menu-item"]:not(.dark *) {
  background: transparent !important;
}

/* Menu buttons - completely transparent by default */
[data-sidebar="menu-button"]:not(.dark *),
[data-slot="sidebar-menu-button"]:not(.dark *) {
  background: transparent !important;
  transition: all 0.15s ease;
  box-shadow: none !important;
}

/* Hover - subtle darkening effect */
[data-sidebar="menu-button"]:hover:not(.dark *),
[data-slot="sidebar-menu-button"]:hover:not(.dark *) {
  background: rgba(22, 163, 74, 0.06) !important;
  box-shadow: none !important;
}

/* Active - slightly darker with subtle left accent (tendril indicator) */
[data-sidebar="menu-button"][data-active="true"]:not(.dark *),
[data-slot="sidebar-menu-button"][data-active="true"]:not(.dark *) {
  background: rgba(22, 163, 74, 0.08) !important;
  box-shadow: inset 3px 0 0 rgba(34, 197, 94, 0.5) !important;
}

/* Active + Hover - slightly more prominent */
[data-sidebar="menu-button"][data-active="true"]:hover:not(.dark *),
[data-slot="sidebar-menu-button"][data-active="true"]:hover:not(.dark *) {
  background: rgba(22, 163, 74, 0.1) !important;
}

/* Sidebar header - clean */
[data-sidebar="header"]:not(.dark *),
[data-slot="sidebar-header"]:not(.dark *) {
  background: transparent !important;
  border: none !important;
}

/* Sidebar footer - clean */
[data-sidebar="footer"]:not(.dark *),
[data-slot="sidebar-footer"]:not(.dark *) {
  background: transparent !important;
  border: none !important;
}

/* Separator between sections - very subtle */
[data-sidebar="separator"]:not(.dark *) {
  background: rgba(22, 163, 74, 0.06);
  height: 1px;
  margin: 4px 8px;
}

/* ===== Badge - Light Mode ===== */
[data-slot="badge"]:not(.dark *) {
  box-shadow: 0 1px 3px rgba(22, 163, 74, 0.08);
}

/* ===== Table Rows - Light Mode Hover ===== */
tr:hover:not(.dark *) td {
  background: linear-gradient(
    135deg,
    rgba(74, 222, 128, 0.04) 0%,
    rgba(134, 239, 172, 0.02) 100%
  );
}

/* ===== Tooltip - Light Mode ===== */
[data-slot="tooltip-content"]:not(.dark *) {
  box-shadow: 
    0 4px 16px rgba(22, 163, 74, 0.12),
    0 2px 4px rgba(0, 0, 0, 0.06);
}

